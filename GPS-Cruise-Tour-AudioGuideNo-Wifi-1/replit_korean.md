# GPS Audio Guide - 프로젝트 개발 기록

## 프로젝트 개요

다국어 지원 GPS 오디오 가이드 PWA 애플리케이션입니다. 관광객을 위한 대화형 지도, 자동 음성 안내, 턴바이턴 네비게이션, 오프라인 기능을 제공합니다.

## Git 커밋 히스토리 (최신순)

### 2024년 12월 - 최근 업데이트

| 커밋 | 설명 |
|------|------|
| `1ffaacd` | 진행 상황 저장 |
| `f993ccd` | CLOVA TTS 음성으로 업데이트 및 음성 선택 개선 |
| `7985668` | CLOVA Voice로 오디오 생성 및 다운로드 기능 업데이트 |
| `22d0462` | 랜드마크 검색에 OR 조건 추가 (다중 단어 검색) |
| `4f74212` | 도시 선택 전 나라 선택 기능 추가 |
| `01b217a` | 랜드마크 필터링을 위한 검색 기능 추가 |

### 앱 출시 및 PWA 기능

| 커밋 | 설명 |
|------|------|
| `5e29f5e` | 앱 배포 (Published) |
| `f49a733` | 다양한 랜드마크에 한국어 오디오 나레이션 추가 |
| `7cf4dd7` | 역할 선택 및 PWA 설치 초기 앱 플로우 설정 |
| `99645c3` | GPS 메인 페이지를 초기 랜딩 페이지로 설정 |

### 성능 최적화

| 커밋 | 설명 |
|------|------|
| `f100fbe` | 특정 페이지의 코드 로딩 최적화로 앱 성능 개선 |
| `835b71d` | 컴포넌트 임포트 최적화로 앱 로딩 속도 개선 |

### CLOVA Voice TTS 통합

| 커밋 | 설명 |
|------|------|
| `fbb11e2` | CLOVA TTS로 문장별 오디오 재생 추가 |
| `34f719e` | CLOVA 음성이 앱 전체에 올바르게 적용되도록 수정 |
| `1491aad` | 선택한 음성 환경설정을 준수하도록 오디오 재생 개선 |
| `2d1b362` | 오디오 설정에 CLOVA 음성 선택 및 관리 추가 |
| `4025a4a` | 오디오 나레이션 및 네비게이션에 CLOVA Voice TTS 통합 추가 |

### 투어 리더 기능

| 커밋 | 설명 |
|------|------|
| `b078ff4` | 다른 앱과 투어 진행 보고서 공유 기능 추가 |
| `2b4291a` | 투어 데이터 가져오기 오류 처리 및 표시 추가 |
| `ea94f63` | 투어 리더를 위한 일정 및 그룹 멤버 관리 기능 추가 |
| `10f171f` | 역할 선택 및 가이드/투어 리더 전용 뷰 추가 |

### 가이드 기능

| 커밋 | 설명 |
|------|------|
| `4b0d797` | 가이드가 새 랜드마크 및 장소 추가 기능 |
| `8f555c8` | 랜드마크 추가 및 데이터베이스에서 가져오기 API 엔드포인트 업데이트 |
| `b88942c` | 가이드가 새 랜드마크 및 활동 추가 기능 |

### 오프라인 기능

| 커밋 | 설명 |
|------|------|
| `3ff66d9` | 오디오 가이드를 정리된 ZIP 파일로 다운로드 기능 추가 |
| `ba1a6be` | 다국어 지원 오프라인 오디오 다운로드 기능 추가 |
| `c09e97d` | 서비스 워커 캐싱 전략 업데이트로 앱 로딩 개선 |

### 지도 및 UI 개선

| 커밋 | 설명 |
|------|------|
| `63f8b3d` | 지도 줌 레벨 일관성 유지 및 자동 리셋 방지 |
| `bd0eae2` | 지도에서 경로 라인 및 세그먼트 마커 숨기기 |
| `df384b0` | 선택 가능한 음성 스타일 및 미리보기로 오디오 설정 향상 |
| `113d5f6` | 사용자 안내를 위한 랜드마크 핀 및 툴팁 표시 개선 |
| `cd3326d` | 지도 랜드마크에 깜빡임 효과 및 툴팁 추가 |

### AI 통합

| 커밋 | 설명 |
|------|------|
| `9806d17` | 향상된 자연어 처리를 위한 Claude AI 통합 추가 |

---

## 주요 기능

### 1. 다국어 지원 (10개 언어)
- 영어 (en), 한국어 (ko), 이탈리아어 (it), 스페인어 (es)
- 프랑스어 (fr), 독일어 (de), 중국어 (zh), 일본어 (ja)
- 포르투갈어 (pt), 러시아어 (ru)

### 2. CLOVA Voice TTS
- 네이버 CLOVA Voice API를 사용한 고품질 음성 합성
- 언어별 전용 음성 제공
  - 한국어: 나라, 민상, 지윤, 수진, 진호 등
  - 영어: Clara, Matt
  - 일본어: Tomoko, Shinji
  - 중국어: Meimei, Liangliang

### 3. 오프라인 기능
- Service Worker를 통한 정적 자산 캐싱
- IndexedDB를 통한 클라이언트 측 데이터 저장
- MP3 오디오 파일 다운로드 및 오프라인 재생

### 4. 투어 리더 모드
- 그룹 일정 관리 (CRUD)
- 그룹 멤버 관리
- Excel 가져오기/내보내기
- Web Share API를 통한 진행 보고서 공유

### 5. 가이드 모드
- 새 랜드마크/활동/레스토랑/기프트샵 추가
- 한국어 UI 지원
- PostgreSQL에 데이터 저장

### 6. AI 투어 추천
- Google Gemini를 사용한 지능형 투어 일정 제안
- 카테고리 기반 추천 (랜드마크, 활동, 레스토랑, 기프트샵)
- 지리적 근접성 및 다양성 고려

### 7. 대화형 지도
- React-Leaflet 및 Leaflet Routing Machine
- GPS 추적 및 턴바이턴 네비게이션
- 카테고리별 색상 코딩된 마커
- 사용자 위치 펄스 애니메이션

---

## 기술 스택

### 프론트엔드
- React 18 + TypeScript
- TanStack React Query
- Tailwind CSS + Shadcn UI
- Wouter (라우팅)
- React-Leaflet (지도)

### 백엔드
- Express.js
- Zod (검증)
- Drizzle ORM

### 데이터베이스
- PostgreSQL (Neon serverless)

### 외부 API
- CLOVA Voice (음성 합성)
- Google Gemini (AI 추천)
- OpenStreetMap (지도 타일)

---

## API 엔드포인트

| 엔드포인트 | 설명 |
|-----------|------|
| `/api/cities` | 도시 목록 조회 |
| `/api/landmarks` | 랜드마크 목록 조회 |
| `/api/visited` | 방문 기록 관리 |
| `/api/offline-package` | 오프라인 패키지 데이터 |
| `/api/ai/recommend-tour` | AI 투어 추천 |
| `/api/audio/generate` | CLOVA TTS 오디오 생성 |
| `/api/audio/voices` | 사용 가능한 TTS 음성 목록 |
| `/api/tour-leader/schedules` | 투어 일정 관리 |
| `/api/tour-leader/members` | 그룹 멤버 관리 |
| `/api/admin/landmarks` | 랜드마크 추가 (관리자) |

---

## 환경 변수

| 변수 | 설명 |
|------|------|
| `DATABASE_URL` | PostgreSQL 연결 문자열 |
| `NAVER_CLIENT_ID` | CLOVA API 클라이언트 ID |
| `NAVER_CLIENT_SECRET` | CLOVA API 클라이언트 시크릿 |
| `GEMINI_API_KEY` | Google Gemini API 키 |
| `SESSION_SECRET` | 세션 암호화 키 |

---

## Git 커밋 히스토리 보는 방법

터미널에서 다음 명령어를 실행하세요:

```bash
# 최근 50개 커밋 보기
git log --oneline -50

# 전체 커밋 기록 보기
GIT_PAGER=cat git log --oneline

# 특정 파일의 변경 기록 보기
git log --oneline -- <파일경로>

# 상세한 커밋 정보 보기
git log -5
```

Replit 웹에서는:
1. 왼쪽 사이드바에서 "Version Control" (버전 관리) 탭 클릭
2. 커밋 기록 목록 확인 가능

---

## 배포 안전 가이드

**중요: 배포 시 데이터베이스 데이터는 자동으로 보존됩니다.**

- `npm run db:push` - 스키마만 동기화, 기존 데이터 유지
- 하드코딩된 데이터와 DB 데이터가 자동 병합됨
- Admin API에서 중복 ID 시 409 에러 반환

---

*최종 업데이트: 2024년 12월*
